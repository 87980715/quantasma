<h1>Backtest</h1>

<form [formGroup]="backtestForm" (ngSubmit)="onSubmit()">

  <label>
    Title: <input formControlName="title"/>
  </label>

  <h2>Parameters</h2>
  <p *ngFor="let param of availableParameters">
    {{param['name']}}: {{param['type']}}
    <button type="button" (click)="addParameter(param['name'])">Specify</button>
  </p>

  <h4>Defined values</h4>
  <div formArrayName="parameters">
    <div *ngFor="let item of parameters.controls; let paramIndex=index" [formGroupName]="paramIndex">
      <div *ngIf="item.value.name != ''">
        <input disabled class="input--invisible" formControlName="name"/>: <input formControlName="value"/>
        <button type="button" (click)="deleteParameter(paramIndex)">X</button>
      </div>
    </div>
  </div>

  <h2>Criterions</h2>
  <div formArrayName="criterions">
    <div *ngFor="let item of criterions.controls; let paramIndex=index" [formGroupName]="paramIndex">
      <select formControlName="name">
        <option>-</option>
        <option *ngFor="let crit of availableCriterions">{{crit}}</option>
      </select>
      <button type="button" (click)="deleteCriterions(paramIndex)">X</button>
    </div>
  </div>
  <button type="button" (click)="addCriterion('')">Add</button>

  <br/>
  <br/>
  <br/>
  <button type="submit">Run</button>
</form>
